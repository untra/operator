{
  "$schema": "./issuetype_schema.json",
  "key": "FIX",
  "name": "Fix",
  "description": "Bug fix, follow-up work, tech debt, or refactoring ticket",
  "mode": "autonomous",
  "glyph": "#",
  "color": "magenta",
  "branch_prefix": "fix",
  "project_required": true,
  "agent_prompt": "Review this project and prepare to create an agent for bug fixes. The agent should read tickets from .tickets/, reproduce issues, implement minimal fixes, verify with tests, and create PRs. Output ONLY the agent system prompt.",
  "fields": [
    {
      "name": "id",
      "description": "Unique ticket identifier",
      "type": "string",
      "required": true,
      "auto": "id",
      "display_order": 0,
      "user_editable": false
    },
    {
      "name": "project",
      "description": "Target project for this fix",
      "type": "string",
      "required": false,
      "default": "",
      "display_order": 1
    },
    {
      "name": "priority",
      "description": "Ticket priority level",
      "type": "enum",
      "required": false,
      "default": "P2-medium",
      "options": ["P0-critical", "P1-high", "P2-medium", "P3-low"],
      "display_order": 2
    },
    {
      "name": "severity",
      "description": "Bug severity (if applicable)",
      "type": "enum",
      "required": false,
      "default": "N/A",
      "options": ["S0-outage", "S1-major", "S2-minor", "S3-cosmetic", "N/A"],
      "display_order": 3
    },
    {
      "name": "status",
      "description": "Ticket status",
      "type": "string",
      "required": true,
      "auto": "status",
      "default": "queued",
      "display_order": 4,
      "user_editable": false
    },
    {
      "name": "created",
      "description": "Creation date",
      "type": "date",
      "required": true,
      "auto": "date",
      "display_order": 5,
      "user_editable": false
    },
    {
      "name": "branch",
      "description": "Git branch name",
      "type": "string",
      "required": true,
      "auto": "branch",
      "display_order": 6,
      "user_editable": false
    },
    {
      "name": "fix_type",
      "description": "Type of fix work",
      "type": "enum",
      "required": false,
      "default": "Bug fix",
      "options": ["Bug fix", "Follow-up work", "Technical debt", "Refactoring", "Test coverage", "Documentation"],
      "display_order": 7
    },
    {
      "name": "summary",
      "description": "name or summary of this bugfix",
      "type": "string",
      "required": true,
      "default": "",
      "placeholder": "Brief description of what needs to be fixed",
      "max_length": 120,
      "display_order": 8
    },
    {
      "name": "parent",
      "description": "Parent / Epic ticket ID",
      "type": "string",
      "required": false,
      "default": "",
      "placeholder": "Parent ticket ID if applicable",
      "display_order": 9
    },
    {
      "name": "context",
      "description": "Context for the fix (steps to reproduce, background)",
      "type": "text",
      "required": false,
      "default": "",
      "placeholder": "Steps to reproduce bug, or context for tech debt",
      "display_order": 10
    }
  ],
  "steps": [
    {
      "name": "plan",
      "display_name": "Planning",
      "outputs": ["plan"],
      "prompt": "Assess the project and plan reproduction:\n\n1. Understand the project structure\n2. Find how to run the project and tests\n3. Locate applicable test code\n4. Create a plan to reproduce the bug\n\nWrite plan to `.tickets/plans/{{ id }}.md` with:\n- How to run the project\n- Relevant test commands\n- Steps to reproduce the issue\n- Initial hypotheses about the root cause",
      "allowed_tools": ["Read", "Glob", "Grep", "Write", "Bash"],
      "requires_review": true,
      "on_reject": {
        "goto_step": "plan",
        "prompt": "Plan rejected: {{ rejection_reason }}\n\nRevise the reproduction plan."
      },
      "next_step": "reproduce"
    },
    {
      "name": "reproduce",
      "display_name": "Reproducing",
      "outputs": ["test", "report"],
      "prompt": "Reproduce the bug:\n\n1. Follow the plan to reproduce the issue\n2. Write a failing test that demonstrates the bug\n3. Document the reproduction in `.tickets/notes/{{ id }}.md`\n4. Confirm the test fails as expected",
      "allowed_tools": ["Read", "Write", "Edit", "Glob", "Grep", "Bash"],
      "requires_review": false,
      "next_step": "test"
    },
    {
      "name": "test",
      "display_name": "Baseline Testing",
      "outputs": ["report"],
      "prompt": "Establish test baseline:\n\n1. Run full test suite to understand current state\n2. Document which tests pass/fail\n3. Identify any related test coverage gaps\n4. Note any flaky or slow tests",
      "allowed_tools": ["Read", "Bash"],
      "requires_review": false,
      "next_step": "fix"
    },
    {
      "name": "fix",
      "display_name": "Fixing",
      "outputs": ["code"],
      "prompt": "Implement the fix:\n\n1. Apply minimal fix to address the root cause\n2. Verify the previously failing test now passes\n3. Run full test suite: `cargo test`\n4. Run linting: `cargo clippy`\n5. Run formatting: `cargo fmt`\n\nKeep the fix focused and minimal.",
      "allowed_tools": ["Read", "Write", "Edit", "Glob", "Grep", "Bash"],
      "requires_review": false,
      "next_step": "deploy"
    },
    {
      "name": "deploy",
      "display_name": "Deploying",
      "outputs": ["review"],
      "prompt": "Create a pull request for the fix:\n\n1. Commit all changes with message: `fix({{ project }}): {{ summary }}`\n2. Push the fix branch\n3. Create a PR with:\n   - Root cause analysis\n   - Description of the fix\n   - Test verification\n   - Link to ticket: {{ id }}\n\nFix complete. Move ticket to completed after PR is merged.",
      "allowed_tools": ["Bash", "Read"],
      "requires_review": true,
      "on_reject": {
        "goto_step": "fix",
        "prompt": "Deploy rejected: {{ rejection_reason }}\n\nAddress feedback and revise the fix."
      }
    }
  ]
}
